(function(t){var e=[];var o=function(t){var o=t.originalEvent.touches;if(o&&o.length){e=[o[0].pageX,o[0].pageY]}};var i=function(o){var i=t(this).triggerHandler;var n=o.originalEvent.touches;var r;if(n&&n.length){var r=[e[0]-n[0].pageX,e[1]-n[0].pageY];var s=Math.abs(r[0])>Math.abs(r[1])?"x":"y";var a=Math.abs(r[0])+Math.abs(r[1]);if(a>25){if(s=="x"){direction=r[0]>=0?"right":"left"}else{direction=r[1]>=0?"down":"up"}t(this).triggerHandler("movement",[direction])}}};var n=function(e){var o=t(this);var e=window.event||e;e=e.originalEvent?e.originalEvent:e;var i=e.detail?e.detail:e.wheelDelta;if(Math.abs(i)>=30){var n=i>0?"up":"down";o.triggerHandler("movement",[n])}};var r=function(e){var o=t(this);var i={38:"up",33:"up",87:"up",40:"down",34:"down",32:"down",83:"down",37:"left",65:"left",39:"right",68:"right"};if(e.which in i){var n=i[e.which];o.triggerHandler("movement",[n])}};t.event.special.movement={add:function(e){t(this).on("mousewheel DOMMouseScroll MozMousePixelScroll",n).on("touchstart",o).on("touchmove",i).on("keydown",r)},remove:function(e){t(this).off("mousewheel DOMMouseScroll MozMousePixelScroll",n).off("touchstart",o).off("touchmove",i).off("keydown",r)}}})(jQuery);(function(t){"use strict";var e=function(e,i){var n=this;this.$element=t(e);this.options=i;this.sectionData=[];this.scrollLock=new o;this.preventScroll=false;this.expandedScrollingMode=false;t("body").css("margin",0);this.$element.css("position","relative");this.draw();t(window).resize(this.draw.bind(this));t(document).on("movement",this.movementHandler.bind(this));if(this.options.guidedScrolling){this.scrollLock.go("lock");this.$element.on("sectionchange.taxi",this.expandedScrollHandler.bind(this))}};e.prototype.draw=function(){var e=[];var o=t(window).height();var i=this.$element.children(this.options.sectionSelector);var n=0;var r=this;i.each(function(i,s){var a=t(s);var l={element:a,top:n,expanded:a.hasClass(r.options.expandedSectionClass)};var c=l.expanded?l.element.outerHeight():o;l.height=c;e.push(l);l.element.css({position:"absolute",top:l.top,width:"100%",height:c,overflow:"hidden"});n+=c});this.sectionData=e;return this};e.prototype.currentSection=function(){var e=t(document).scrollTop();var o=this.sectionData.length;while(o--){if(e>=this.sectionData[o].top){return o}}return 0};e.prototype.to=function(e){if(e>=this.sectionData.length){t.error("Out of range: this instance only has "+this.sectionData.length+" sections")}if(this.preventScroll){return false}var o=this.currentSection();var i=this.sectionData[e];if(o<e){var n=i.top}else{var n=i.top+i.height-t(window).height()}this.transform(n);return this};e.prototype.previous=function(){var t=this.currentSection();return t>0?this.to(t-1):false};e.prototype.next=function(){var t=this.currentSection();return t<this.sectionData.length-1?this.to(t+1):false};e.prototype.transform=function(e){var o=this;this.scrollLock.go("lock");this.preventScroll=true;t.fn.taxi.transform(this.$element,e,this.options).done(function(){o.preventScroll=false;!o.options.guidedScrolling&&o.scrollLock.go("unlock");o.checkSectionChange()});return this};e.prototype.checkSectionChange=function(){var t=this.currentSection();if(this._currentSection!=t){this.$element.trigger("sectionchange.taxi",[t])}this._currentSection=t};e.prototype.movementHandler=function(t,e){if(this.options.guidedScrolling&&!this.expandedScrollingMode){if(!this.preventScroll){if(e=="up"){this.previous()}else if(e=="down"){this.next()}}}};e.prototype.expandedScrollHandler=function(e,o){if(this.sectionData[o].expanded){var i=function(){var e=t(window).height();var n=t(document).scrollTop();var r=this.sectionData[o].height;var s=this.sectionData[o].top;var a=e+n>s+r;var l=n<s;if(l||a){this.expandedScrollingMode=false;this.scrollLock.go("lock");t(document).off("scroll",i);if(l){t(document).scrollTop(s)}else{t(document).scrollTop(s+r-e)}}}.bind(this);this.expandedScrollingMode=true;this.scrollLock.go("unlock");t(document).on("scroll",i)}};e.prototype.publicMethods=["draw","to","next","previous","currentSection"];var o=function(){this.isLocked=false;this.evtString="mousewheel.scrolllock DOMMouseScroll.scrolllock             MozMousePixelScroll.scrolllock touchstart.scrolllock             touchmove.scrolllock keydown.scrolllock";this.lockHandler=function(t){var e=[33,32,34,37,38,39,40,65,68,83,87];if(t.type!=="keydown"||e.indexOf(t.keyCode)>-1){t.preventDefault()}}};o.prototype.go=function(e){if(!e)return this.isLocked;if(e=="lock"&&!this.isLocked){t(document).on(this.evtString,this.lockHandler);this.isLocked=true}else if(e=="unlock"&&this.isLocked){t(document).off(this.evtString,this.lockHandler);this.isLocked=false}};t.fn.taxi=function(o){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this);var r=n.data("jquery.taxi");var s=t.extend({},t.fn.taxi.defaults,typeof o=="object"&&o);if(!r){n.data("jquery.taxi",r=new e(this,s))}else{if(o){if(typeof o=="string"&&r.publicMethods.indexOf(o)>-1){return r[o].apply(r,i)}else{t.error("Method "+o+" does not exist on jQuery.taxi")}}}})};t.fn.taxi.transform=function(e,o,i){var n=t.Deferred();var r=t(document).scrollTop();var s=o-r;var a="all "+i.scrollSpeed+"ms ease";t(window).scrollTop(o);e.css("margin-top",s);e[0].offsetHeight;e.css({"-webkit-transition":a,transition:a,"margin-top":0});e[0].offsetHeight;e.css({"-webkit-transition":"all 0ms ease",transition:"all 0ms ease"});e.one("transitionend webkitTransitionEnd",n.resolve);return n.promise()};t.fn.taxi.defaults={sectionSelector:"section",expandedSectionClass:"expanded",guidedScrolling:true,scrollSpeed:1e3}})(jQuery);