(function(e){var t=[];var o=function(e){var o=e.originalEvent.touches;if(o&&o.length){t=[o[0].pageX,o[0].pageY]}};var i=function(o){var i=e(this).triggerHandler;var n=o.originalEvent.touches;var r;if(n&&n.length){var r=[t[0]-n[0].pageX,t[1]-n[0].pageY];var s=Math.abs(r[0])>Math.abs(r[1])?"x":"y";var a=Math.abs(r[0])+Math.abs(r[1]);if(a>25){if(s=="x"){direction=r[0]>=0?"right":"left"}else{direction=r[1]>=0?"down":"up"}e(this).triggerHandler("movement",[direction])}}};var n=function(t){var o=e(this);var t=window.event||t;t=t.originalEvent?t.originalEvent:t;var i=t.detail?t.detail:t.wheelDelta;if(Math.abs(i)>=30){var n=i>0?"up":"down";o.triggerHandler("movement",[n])}};var r=function(t){var o=e(this);var i={38:"up",33:"up",87:"up",40:"down",34:"down",32:"down",83:"down",37:"left",65:"left",39:"right",68:"right"};if(t.which in i){var n=i[t.which];o.triggerHandler("movement",[n])}};e.event.special.movement={add:function(t){e(this).on("mousewheel DOMMouseScroll MozMousePixelScroll",n).on("touchstart",o).on("touchmove",i)},remove:function(t){e(this).off("mousewheel DOMMouseScroll MozMousePixelScroll",n).off("touchstart",o).off("touchmove",i)}}})(jQuery);(function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.sectionData=[];this.preventTransform=false;this.expandedScrollingMode=false;this.scrollLock=new o;e("body").css("margin",0);this.$element.css("position","relative");this.draw();e(window).resize(this.draw.bind(this));if(this.options.guidedScrolling){this.scrollLock.go("lock");e(document).on("movement",this._movementHandler.bind(this));this.$element.on("sectionchange.taxi",this._expandedScrollHandler.bind(this))}else{e(document).on("scroll",this._sectionChangeHandler.bind(this))}if(this.options.hideScrollbar){e("<style type='text/css'>::-webkit-scrollbar { display: none; }</style>").appendTo("head")}};t.prototype._sectionChangeHandler=function(){var e=this._currentSection();if(this._cur!=e){this.$element.trigger("sectionchange.taxi",[e,this._cur])}this._cur=e};t.prototype._movementHandler=function(e,t){if(!this.expandedScrollingMode&&!this.preventTransform){if(t=="up"){this.previous(true)}else if(t=="down"){this.next()}}};t.prototype._expandedScrollHandler=function(t,o){if(this.sectionData[o].expanded){var i=function(){var t=e(window).height();var n=e(document).scrollTop();var r=this.sectionData[o].height;var s=this.sectionData[o].top;var a=t+n>s+r+this.options.expandedScrollOffThreshold;var l=n<s-this.options.expandedScrollOffThreshold;if(l||a){this.expandedScrollingMode=false;this.scrollLock.go("lock");e(document).off("scroll",i);if(l){this.to(o-1,true,o)}else{this.to(o+1,false,o)}}}.bind(this);this.expandedScrollingMode=true;this.scrollLock.go("unlock");e(document).on("scroll",i)}};t.prototype._currentSection=function(){var t=e(document).scrollTop();var o=this.sectionData.length;while(o--){var i=this.sectionData[o];if(i.expanded&&t>=i.top-this.options.expandedScrollOffThreshold||!i.expanded&&t>=i.top){return o}}return 0};t.prototype.draw=function(){var t=this;var o=[];var i=e(window).height();var n=this.$element.children(this.options.sectionSelector);var r=0;n.each(function(n,s){var a=e(s);var l={element:a,top:r,expanded:a.hasClass(t.options.expandedSectionClass)};a.css("height","auto");var c=l.expanded?l.element.outerHeight():i;l.height=c;o.push(l);l.element.css({position:"absolute",top:l.top,width:"100%",height:c,overflow:"hidden"});r+=c});n.find("[data-taxi-full-height]").css("height",i);this.sectionData=o;return this};t.prototype.snap=function(){var t=e(document).scrollTop();var o=this._currentSection();var i=this.sectionData[o];if(t!=i.top){this.transform(i.top)}return this};t.prototype.to=function(t,o,i){var n=this;if(t>=this.sectionData.length){e.error("Out of range: this instance only has "+this.sectionData.length+" sections")}var i=i||this._currentSection();var r=this.sectionData[t];o=typeof o==="boolean"?o:false;if(o){var s=r.top+r.height-e(window).height()}else{var s=r.top}this.$element.trigger("moveto.start.taxi",[t,i]);this.transform(s).done(function(){n.$element.trigger("moveto.end.taxi",[t,i])});return this};t.prototype.previous=function(e){var t=this._currentSection();var o=t>0?t-1:t;return this.to(o,e)};t.prototype.next=function(e){var t=this._currentSection();var o=t<this.sectionData.length-1?t+1:t;return this.to(o,e)};t.prototype.transform=function(t){var o=this;var i=e.Deferred();if(this.preventTransform||t<0||t>e(document).height()){i.reject()}else if(e(document).scrollTop()==t){i.resolve()}else{this.$element.trigger("transform.start.taxi");this.preventTransform=true;if(!this.options.guidedScrolling)this.scrollLock.go("lock");e.fn.taxi.transform(this.$element,t,this.options).done(function(){o.preventTransform=false;o._sectionChangeHandler();if(!o.options.guidedScrolling)o.scrollLock.go("unlock");i.resolve();o.$element.trigger("transform.end.taxi")})}return i.promise()};t.prototype.expand=function(t,o){var i=this;if(!o){var n=this._currentSection()}else if(typeof o==="number"){var n=o}else{var n=this.$element.children().index(o)}var r=this.sectionData[n];var s=this._currentSection();var a=r.height-e(window).height();var l=e(document).scrollTop();var c=function(){r.element.addClass("expanded");i.draw();if(s==n){i._expandedScrollHandler(null,n)}else if(s>n){e(document).scrollTop(l+a)}i.$element.trigger("sectionexpand.taxi",[n])};var h=function(){if(s==n){i.transform(r.top).done(function(){r.element.removeClass("expanded");i.draw();i.expandedScrollingMode=false;i.$element.trigger("sectioncollapse.taxi",[n])})}else if(s>n){e(document).scrollTop(l-a);r.element.removeClass("expanded");i.draw();i.$element.trigger("sectioncollapse.taxi",[n])}else{r.element.removeClass("expanded");i.draw();i.$element.trigger("sectioncollapse.taxi",[n])}};if(!r.expanded&&(t=="expand"||t=="toggle")){c()}else if(r.expanded&&(t=="collapse"||t=="toggle")){h()}return this};var o=function(){this.isLocked=false};o.prototype.go=function(t){if(!t)return this.isLocked;if(t=="lock"&&!this.isLocked){e("body").css("overflow","hidden");this.isLocked=true}else if(t=="unlock"&&this.isLocked){e("body").css("overflow","visible");this.isLocked=false}};e.fn.taxi=function(o){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=e(this);var r=n.data("jquery.taxi");var s=e.extend({},e.fn.taxi.defaults,typeof o=="object"&&o);if(!r){n.data("jquery.taxi",r=new t(this,s))}else{if(o){if(typeof o=="string"&&o in r){return r[o].apply(r,i)}else{e.error("Method "+o+" does not exist on jQuery.taxi")}}}})};e.fn.taxi.constructor=t;e.fn.taxi.transform=function(t,o,i){var n=e.Deferred();var r=e(document).scrollTop();var s=o-r;var a=i.scrollSpeed+"ms ease";var l="translate(0, "+s+"px)";e(window).scrollTop(o);t.css({"-webkit-transform":l,transform:l});t[0].offsetHeight;t.css({transform:"translate(0, 0)","-webkit-transform":"translate(0, 0)",transition:a,"-webkit-transition":a});t[0].offsetHeight;t.css({"-webkit-transition":"0ms ease",transition:"0ms ease"});t.one("transitionend webkitTransitionEnd",n.resolve);return n.promise()};e.fn.taxi.defaults={sectionSelector:"section",expandedSectionClass:"expanded",guidedScrolling:true,scrollSpeed:1e3,expandedScrollOffThreshold:200,hideScrollbar:true}})(jQuery);