(function(e){var t=[];var o=function(e){var o=e.originalEvent.touches;if(o&&o.length){t=[o[0].pageX,o[0].pageY]}};var n=function(o){var n=e(this).triggerHandler;var i=o.originalEvent.touches;var r;if(i&&i.length){var r=[t[0]-i[0].pageX,t[1]-i[0].pageY];var s=Math.abs(r[0])>Math.abs(r[1])?"x":"y";var a=Math.abs(r[0])+Math.abs(r[1]);if(a>25){if(s=="x"){direction=r[0]>=0?"right":"left"}else{direction=r[1]>=0?"down":"up"}e(this).triggerHandler("movement",[direction])}}};var i=function(t){var o=e(this);var t=window.event||t;t=t.originalEvent?t.originalEvent:t;var n=t.detail?t.detail:t.wheelDelta;if(Math.abs(n)>=30){var i=n>0?"up":"down";o.triggerHandler("movement",[i])}};var r=function(t){var o=e(this);var n={38:"up",33:"up",87:"up",40:"down",34:"down",32:"down",83:"down",37:"left",65:"left",39:"right",68:"right"};if(t.which in n){var i=n[t.which];o.triggerHandler("movement",[i])}};e.event.special.movement={add:function(t){e(this).on("mousewheel DOMMouseScroll MozMousePixelScroll",i).on("touchstart",o).on("touchmove",n).on("keydown",r)},remove:function(t){e(this).off("mousewheel DOMMouseScroll MozMousePixelScroll",i).off("touchstart",o).off("touchmove",n).off("keydown",r)}}})(jQuery);(function(e){"use strict";var t=function(t,n){var i=this;this.$element=e(t);this.options=n;this.sectionData=[];this.scrollLock=new o;this.preventScroll=false;this.expandedScrollingMode=false;e("body").css("margin",0);this.$element.css("position","relative");this.draw();e(window).resize(this.draw.bind(this));e(document).on("movement",this.movementHandler.bind(this));if(this.options.guidedScrolling){this.scrollLock.go("lock");this.$element.on("sectionchange.taxi",this.expandedScrollHandler.bind(this))}if(this.options.hideScrollbar){e("<style type='text/css'>::-webkit-scrollbar { display: none; }</style>").appendTo("head")}};t.prototype.draw=function(){var t=this;var o=[];var n=e(window).height();var i=this.$element.children(this.options.sectionSelector);var r=0;i.each(function(i,s){var a=e(s);var l={element:a,top:r,expanded:a.hasClass(t.options.expandedSectionClass)};a.css("height","auto");var c=l.expanded?l.element.outerHeight():n;l.height=c;o.push(l);l.element.css({position:"absolute",top:l.top,width:"100%",height:c,overflow:"hidden"});r+=c});i.find("[data-taxi-full-height]").css("height",n);this.sectionData=o;return this};t.prototype.currentSection=function(){var t=e(document).scrollTop();var o=this.sectionData.length;while(o--){if(t>=this.sectionData[o].top){return o}}return 0};t.prototype.snap=function(){var t=e(document).scrollTop();var o=this.currentSection();var n=this.sectionData[o];if(t!=n.top){this.to(o)}};t.prototype.to=function(t){if(t>=this.sectionData.length){e.error("Out of range: this instance only has "+this.sectionData.length+" sections")}if(this.preventScroll){return false}var o=this.currentSection();var n=this.sectionData[t];if(o<t){var i=n.top}else{var i=n.top+n.height-e(window).height()}this.transform(i);return this};t.prototype.previous=function(e){e=typeof e==="boolean"?e:false;var t=this.currentSection();return t>0?this.to(t-1):this.snap()};t.prototype.next=function(e){e=typeof e==="boolean"?e:false;var t=this.currentSection();return t<this.sectionData.length-1?this.to(t+1):this.snap()};t.prototype.transform=function(t){var o=this;var n=e.Deferred();this.scrollLock.go("lock");this.preventScroll=true;e.fn.taxi.transform(this.$element,t,this.options).done(function(){o.preventScroll=false;if(!o.options.guidedScrolling)o.scrollLock.go("unlock");o.checkSectionChange();n.resolve()});return n.promise()};t.prototype.toggleExpanded=function(t){if(typeof t==="number"){var o=t;console.log("number",o)}else{var o=this.$element.children().index(t);console.log("object",o)}var n=this;var i=this.sectionData[o];var r=this.currentSection();var s=i.element[0].scrollHeight-e(window).height();var a=e(document).scrollTop();if(i.expanded){if(r==o){this.transform(i.top).done(function(){i.element.removeClass("expanded");n.draw();n.expandedScrollingMode=false})}else if(r>o){e(document).scrollTop(a-s);i.element.removeClass("expanded");n.draw()}else{i.element.removeClass("expanded");n.draw()}}else{i.element.addClass("expanded");n.draw();if(r==o){n.expandedScrollHandler(null,o)}else if(r>o){e(document).scrollTop(a+s)}}};t.prototype.checkSectionChange=function(){var e=this.currentSection();if(this._currentSection!=e){this.$element.trigger("sectionchange.taxi",[e])}this._currentSection=e};t.prototype.movementHandler=function(e,t){if(this.options.guidedScrolling&&!this.expandedScrollingMode){if(!this.preventScroll){if(t=="up"){this.previous()}else if(t=="down"){this.next()}}}};t.prototype.expandedScrollHandler=function(t,o){if(this.sectionData[o].expanded){var n=function(){var t=e(window).height();var i=e(document).scrollTop();var r=this.sectionData[o].height;var s=this.sectionData[o].top;var a=t+i>s+r+this.options.expandedScrollOffThreshold;var l=i<s-this.options.expandedScrollOffThreshold;if(l||a){this.expandedScrollingMode=false;this.scrollLock.go("lock");e(document).off("scroll",n)}}.bind(this);this.expandedScrollingMode=true;this.scrollLock.go("unlock");e(document).on("scroll",n)}};t.prototype.publicMethods=["draw","next","previous","snap","to","toggleExpanded"];var o=function(){this.isLocked=false;this.evtString="mousewheel.scrolllock DOMMouseScroll.scrolllock             MozMousePixelScroll.scrolllock touchstart.scrolllock             touchmove.scrolllock keydown.scrolllock";this.lockHandler=function(e){var t=[33,32,34,37,38,39,40,65,68,83,87];if(e.type!=="keydown"||t.indexOf(e.keyCode)>-1){e.preventDefault()}}};o.prototype.go=function(t){if(!t)return this.isLocked;if(t=="lock"&&!this.isLocked){e(document).on(this.evtString,this.lockHandler);this.isLocked=true}else if(t=="unlock"&&this.isLocked){e(document).off(this.evtString,this.lockHandler);this.isLocked=false}};e.fn.taxi=function(o){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var i=e(this);var r=i.data("jquery.taxi");var s=e.extend({},e.fn.taxi.defaults,typeof o=="object"&&o);if(!r){i.data("jquery.taxi",r=new t(this,s))}else{if(o){if(typeof o=="string"&&r.publicMethods.indexOf(o)>-1){return r[o].apply(r,n)}else{e.error("Method "+o+" does not exist on jQuery.taxi")}}}})};e.fn.taxi.transform=function(t,o,n){var i=e.Deferred();var r=e(document).scrollTop();var s=o-r;var a=n.scrollSpeed+"ms ease";var l="translate(0, "+s+"px)";e(window).scrollTop(o);t.css({"-webkit-transform":l,transform:l});t[0].offsetHeight;t.css({transform:"translate(0, 0)","-webkit-transform":"translate(0, 0)",transition:a,"-webkit-transition":a});t[0].offsetHeight;t.css({"-webkit-transition":"0ms ease",transition:"0ms ease"});t.one("transitionend webkitTransitionEnd",i.resolve);return i.promise()};e.fn.taxi.defaults={sectionSelector:"section",expandedSectionClass:"expanded",guidedScrolling:true,scrollSpeed:1e3,expandedScrollOffThreshold:200,hideScrollbar:true}})(jQuery);